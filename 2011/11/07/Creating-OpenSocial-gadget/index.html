<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Creating OpenSocial gadget with Asp.Net MVC | A drop in the ocean</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="OpenSocial is a great standard that allows implement Web-gadgets for various web-sites and portals (they are called OpenSocial Containers). Initially developed for Social Networks and driven by Google">
<meta property="og:type" content="article">
<meta property="og:title" content="Creating OpenSocial gadget with Asp.Net MVC">
<meta property="og:url" content="http://megaboich.github.io/blog/2011/11/07/Creating-OpenSocial-gadget/index.html">
<meta property="og:site_name" content="A drop in the ocean">
<meta property="og:description" content="OpenSocial is a great standard that allows implement Web-gadgets for various web-sites and portals (they are called OpenSocial Containers). Initially developed for Social Networks and driven by Google">
<meta property="og:image" content="http://megaboich.github.io/blog/blog/2011/11/07/Creating-OpenSocial-gadget/initialWidgetView_4.png">
<meta property="og:image" content="http://megaboich.github.io/blog/blog/2011/11/07/Creating-OpenSocial-gadget/gadgetXml_2.png">
<meta property="og:image" content="http://megaboich.github.io/blog/blog/2011/11/07/Creating-OpenSocial-gadget/LiferayFirstStart_2.png">
<meta property="og:image" content="http://megaboich.github.io/blog/blog/2011/11/07/Creating-OpenSocial-gadget/LifeRayInsertGadgetUrl_2.png">
<meta property="og:image" content="http://megaboich.github.io/blog/blog/2011/11/07/Creating-OpenSocial-gadget/LifeRayWithGadget_2.png">
<meta property="og:image" content="http://megaboich.github.io/blog/blog/2011/11/07/Creating-OpenSocial-gadget/GadgetSettings_2.png">
<meta property="og:image" content="http://megaboich.github.io/blog/blog/2011/11/07/Creating-OpenSocial-gadget/Gadget%20on%20iGoogle_2.png">
<meta property="og:updated_time" content="2016-06-04T16:22:36.967Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Creating OpenSocial gadget with Asp.Net MVC">
<meta name="twitter:description" content="OpenSocial is a great standard that allows implement Web-gadgets for various web-sites and portals (they are called OpenSocial Containers). Initially developed for Social Networks and driven by Google">
<meta name="twitter:image" content="http://megaboich.github.io/blog/blog/2011/11/07/Creating-OpenSocial-gadget/initialWidgetView_4.png">
  
    <link rel="alternate" href="/atom.xml" title="A drop in the ocean" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/blog/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">A drop in the ocean</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
          <a class="main-nav-link" href="/blog/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://megaboich.github.io/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Creating-OpenSocial-gadget" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2011/11/07/Creating-OpenSocial-gadget/" class="article-date">
  <time datetime="2011-11-06T23:00:00.000Z" itemprop="datePublished">2011-11-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Creating OpenSocial gadget with Asp.Net MVC
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://docs.opensocial.org/display/OS/Home" target="_blank" rel="external">OpenSocial</a> is a great standard that allows implement Web-gadgets for various web-sites and portals (they are called OpenSocial Containers). Initially developed for Social Networks and driven by Google and <a href="http://code.google.com/apis/gadgets/" target="_blank" rel="external">Google gadgets</a> this standart is also becoming popular in corporate web portals sector. Currently such vendors as IBM, SAP, Cisco and many others have support for OpenSocial in theirs corporate products. All this success simply explained by the fact that OpenSocial allows quickly integrate gadgets to various of host portals.</p>
<p>I will use Simple RSS reader Web application that I have created in previous article. I am going to implement OpenSocial integration, so I will able to put my gadget with RSS to any OpenSocial container.</p>
<p>Requirements to gadget:</p>
<ol>
<li>Display list of headlines with images.</li>
<li>Loading of Rss content should be performed asynchronously by ajax, so container will not slow down while loading the page.</li>
<li>Url of feed and count of displayed items should be configurable by user.</li>
</ol>
<p>Unfortunately Rss format is not providing any information about image associated with the article. So, I updated RssReaderService a little. Now it scans article content of first <img> tag and associates that url with article. <a href="http://stackoverflow.com/questions/138839/how-do-you-parse-a-html-string-for-image-tags-to-get-at-the-src-information" target="_blank" rel="external">There are tons</a> of different ways to parse contents of HTML. I prefer to use HtmlAgilityPack library that is easy to get through NuGet package manager. I think that XPath is more maintainable than RegEx and this is more important in this case than performance.</p>
<p>Now our service layer is ready, we will go to create UI. (If you are curious about implementation, you can find a link to project sources in the end of article).</p>
<h2 id="Create-UI-for-widget"><a href="#Create-UI-for-widget" class="headerlink" title="Create UI for widget."></a>Create UI for widget.</h2><p>First create new controller action for widget:<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">Widget</span>(<span class="params"><span class="keyword">string</span> feedUrl, <span class="keyword">int</span> topCount</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> View(<span class="keyword">new</span> RssWidgetModel</span><br><span class="line">	&#123;</span><br><span class="line">		FeedSource = feedUrl,</span><br><span class="line">		TopCount = topCount</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Then create view:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">@model SimpleRssReader.Models.RssWidgetModel</span><br><span class="line">@&#123;</span><br><span class="line">	Layout = <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">var</span> AbsoluteRootUrlPart = Request.Url.GetLeftPart(UriPartial.Authority);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"@(AbsoluteRootUrlPart + Url.Content("</span>~/Scripts/Views/WidgetHelper.js<span class="string">"))"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;link href=<span class="string">"@(AbsoluteRootUrlPart + Url.Content("</span>~/Content/HeadlinesRss.css<span class="string">"))"</span> rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=<span class="string">"rss-widget-content"</span>&gt;</span><br><span class="line">	&lt;div <span class="keyword">class</span>=<span class="string">"loading-indicator"</span>&gt;</span><br><span class="line">		&lt;img style=<span class="string">"margin-top:60px"</span> src=<span class="string">"@(AbsoluteRootUrlPart + Url.Content("</span>~/Content/images/ajax-loader.gif<span class="string">"))"</span> /&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"></span><br><span class="line">	$(function () &#123;</span><br><span class="line">		<span class="keyword">var</span> serviceUrl = <span class="string">'@Html.Raw(AbsoluteRootUrlPart + Url.Action("ViewHeadlines"))'</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//Default values</span></span><br><span class="line">		<span class="keyword">var</span> gadgetPrefs = &#123;</span><br><span class="line">			feedSource: <span class="string">'@Html.Raw(Model.FeedSource)'</span>,</span><br><span class="line">			topCount: <span class="string">'@Model.TopCount'</span></span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> userPrefs = $.widgetHelper.getUserProperties([<span class="string">'feedSource'</span>, <span class="string">'topCount'</span>]);</span><br><span class="line">		<span class="keyword">if</span> (userPrefs != <span class="literal">null</span>) &#123;</span><br><span class="line">			$.extend(gadgetPrefs, userPrefs);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		serviceUrl +=</span><br><span class="line">			 <span class="string">"?feedUrl="</span> + encodeURIComponent(gadgetPrefs.feedSource)</span><br><span class="line">			+ <span class="string">"&amp;topCount="</span> + encodeURIComponent(gadgetPrefs.topCount);</span><br><span class="line"></span><br><span class="line">		$.ajax(&#123;</span><br><span class="line">			url: serviceUrl,</span><br><span class="line">			dataType: <span class="string">"jsonp"</span>,</span><br><span class="line">			crossDomain: <span class="literal">true</span>,</span><br><span class="line">			success: function (data) &#123;</span><br><span class="line">				$(<span class="string">'#rss-widget-content'</span>).html(data.markup);</span><br><span class="line">				$.widgetHelper.adjustHeight();</span><br><span class="line"></span><br><span class="line">				$.widgetHelper.setTitle($(<span class="string">"#items"</span>).attr(<span class="string">'data-title'</span>));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">		$(<span class="string">'body'</span>).bind(<span class="string">'imageLoad'</span>, function () &#123;</span><br><span class="line">			$.widgetHelper.adjustHeight();</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>At initial point only loading animation rendered and on documentready event will execute following script actions:</p>
<ol>
<li>Define serviceUrl and default options for gadget in gadgetPrefs object.</li>
<li>Load user settings with WidgetHelper.</li>
<li>Build url to dynamic Rss content and performing Ajax to query it.</li>
<li>On success callback retrieved HTML inserted to DOM instead of loading animation. Also called some integration functions that will implemented later to adjust gadget height and title.</li>
<li>Notice that all url’s used in view are rendered in absolute scheme. Generally this is not required for widget used in iframe, but for OpenSocial it matters a lot, and there are some reasons for that. Later when our gadget will be integrated to 3rd party container, just open View source in browser and discover how container did rendering job. Scripts and styles will be minimized and combined, and more important all view will be served from containers server. So, for calling ours resources and ajax handlers we need to specify absolute urls.</li>
</ol>
<p>I included jQuery to perform Ajax and DOM manipulations. Also there is custom script WidgetHelper.js to perform widget manipulation. This is facade for OpenSocial integration and it provides stubs when OpenSocial is not available.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">$, undefined</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">adjustHeight</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">typeof</span> (gadgets) != <span class="string">'undefined'</span>) &#123;</span><br><span class="line">			gadgets.window.adjustHeight()</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">getUserProperties</span>(<span class="params">propList</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">typeof</span> (gadgets) != <span class="string">'undefined'</span>) &#123;</span><br><span class="line">			<span class="keyword">var</span> prefs = <span class="keyword">new</span> gadgets.Prefs();</span><br><span class="line">			<span class="keyword">var</span> props = &#123;&#125;;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; propList.length; ++i) &#123;</span><br><span class="line">				props[propList[i]] = prefs.getString(propList[i]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> props;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">setTitle</span>(<span class="params">newTitle</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">typeof</span> (gadgets) != <span class="string">'undefined'</span>) &#123;</span><br><span class="line">			gadgets.window.setTitle(newTitle);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	$.extend(&#123;</span><br><span class="line">		widgetHelper: &#123;</span><br><span class="line">			adjustHeight: adjustHeight,</span><br><span class="line">			getUserProperties: getUserProperties,</span><br><span class="line">			setTitle: setTitle</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;)(jQuery);</span><br></pre></td></tr></table></figure>
<p>In next step create controller action for dynamic Rss content:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[JsonpMarkup]</span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">ViewHeadlines</span>(<span class="params"><span class="keyword">string</span> feedUrl, <span class="keyword">int</span> topCount</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> rssService = <span class="keyword">new</span> RssReaderService();</span><br><span class="line">	<span class="keyword">var</span> model = rssService.ReadFeed(feedUrl, topCount);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> View(model);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And view:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@model SimpleRssReader.Models.RssFeedContent</span><br><span class="line">@&#123;</span><br><span class="line">	Layout = <span class="literal">null</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;div id=<span class="string">"items"</span> data-title=<span class="string">"@Model.FeedTitle"</span>&gt;</span><br><span class="line">	&lt;ul&gt;</span><br><span class="line">	@<span class="keyword">foreach</span> (<span class="keyword">var</span> rssItem <span class="keyword">in</span> Model.Articles)</span><br><span class="line">	&#123;</span><br><span class="line">		&lt;li&gt;</span><br><span class="line">			&lt;h2&gt;</span><br><span class="line">				&lt;a href=<span class="string">"@rssItem.Link"</span> target=<span class="string">"_blank"</span>&gt;</span><br><span class="line">					@<span class="keyword">if</span> (!<span class="keyword">string</span>.IsNullOrEmpty(rssItem.TitleImage))</span><br><span class="line">					&#123; </span><br><span class="line">						&lt;img src=<span class="string">"@rssItem.TitleImage"</span> onload=<span class="string">"$('body').trigger('imageLoad');"</span> /&gt;</span><br><span class="line">					&#125;</span><br><span class="line">					@rssItem.Title</span><br><span class="line">				&lt;/a&gt;</span><br><span class="line">			&lt;/h2&gt;</span><br><span class="line">		&lt;/li&gt;</span><br><span class="line">	&#125;</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>At this point after compiling and fixing some minor problems there should be available working widget at url like this : <a href="http://localhost/reader/RssReader/Widget?feedUrl=http%3A%2F%2Fnews.google.com%2Fnews%3Ftopic%3Db%26output%3Drss&amp;topCount=10" target="_blank" rel="external">http://localhost/reader/RssReader/Widget?feedUrl=http%3A%2F%2Fnews.google.com%2Fnews%3Ftopic%3Db%26output%3Drss&amp;topCount=10</a></p>
<p>And you should get view like this:<br><img src="/blog/2011/11/07/Creating-OpenSocial-gadget/initialWidgetView_4.png" alt="View of the widget in the browser" title="View of the widget in the browser"></p>
<h2 id="Create-Gadget-XML"><a href="#Create-Gadget-XML" class="headerlink" title="Create Gadget XML."></a>Create Gadget XML.</h2><p>OpenSocial Gadget should be described in XML according to specification. To achieve this let’s create Controller and View.</p>
<p>Controller code:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Web;</span><br><span class="line"><span class="keyword">using</span> System.Web.Mvc;</span><br><span class="line"><span class="keyword">using</span> SimpleRssReader.Models;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">SimpleRssReader.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OpenSocialController</span> : <span class="title">Controller</span></span><br><span class="line">	&#123;</span><br><span class="line">		[HttpGet]</span><br><span class="line">		<span class="function"><span class="keyword">public</span> ActionResult <span class="title">RssFeedGadget</span>(<span class="params"></span><br><span class="line">			<span class="keyword">string</span> feed = <span class="string">"http://news.google.com/news?topic=b&amp;output=rss"</span>,</span><br><span class="line">			<span class="keyword">int</span> top = <span class="number">10</span></span>)</span><br><span class="line">		</span>&#123;</span><br><span class="line">			ViewBag.FeedSource = feed;</span><br><span class="line">			ViewBag.TopCount = top;</span><br><span class="line">			<span class="keyword">return</span> View(<span class="string">"RssFeedGadget"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And this is View:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">using</span> System;</span><br><span class="line">@&#123;</span><br><span class="line">	Layout = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span><br><span class="line">&lt;Module&gt;</span><br><span class="line">	&lt;ModulePrefs title=<span class="string">"Rss Feed Widget"</span> author=<span class="string">"Oleksandr Boiko"</span> author_email=<span class="string">"mega.boich@gmail.com"</span> height=<span class="string">"160"</span>&gt;</span><br><span class="line">		&lt;Require feature=<span class="string">"opensocial-0.9"</span> /&gt;</span><br><span class="line">		&lt;Require feature=<span class="string">"dynamic-height"</span>/&gt;</span><br><span class="line">		&lt;Require feature=<span class="string">"settitle"</span>/&gt;</span><br><span class="line">	&lt;/ModulePrefs&gt;</span><br><span class="line">	&lt;UserPref name=<span class="string">"feedSource"</span> display_name=<span class="string">"Feed Source"</span> default_value=<span class="string">"http://news.google.com/news?topic=b&amp;amp;output=rss"</span>/&gt;</span><br><span class="line">	&lt;UserPref name=<span class="string">"topCount"</span> display_name=<span class="string">"Top Count"</span> default_value=<span class="string">"10"</span>/&gt;</span><br><span class="line">	&lt;Content type=<span class="string">"html"</span>&gt;</span><br><span class="line">&lt;![CDATA[</span><br><span class="line">	@Html.Action(<span class="string">"Widget"</span>, <span class="string">"RssReader"</span>, <span class="keyword">new</span> &#123; feedUrl = ViewBag.FeedSource, topCount = ViewBag.TopCount &#125;)</span><br><span class="line">]]&gt;</span><br><span class="line">	&lt;/Content&gt;</span><br><span class="line">&lt;/Module&gt;</span><br><span class="line">@&#123;</span><br><span class="line">	Response.ContentType = <span class="string">"text/xml"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This is OpenSocial Gadget Xml, and it contains all information to render gadget in container. Google have good <a href="http://code.google.com/intl/uk-UA/apis/gadgets/docs/gs.html" target="_blank" rel="external">documentation</a> about this. In ModulePrefs section located copyright attributes and required features. UserPref sections contains user preferences that will be available to user. Access to this preferences is performed via OpenSocial Javascript API in WidgetHelper.js. Section Content is the container for HTML, CSS, Javascript. Here goes rendering of the Widget action.</p>
<p>So, now you should have a working gadget XML available at url like this: <a href="http://localhost/reader/OpenSocial/RssFeedGadget?feedUrl=http%3A%2F%2Fnews.google.com%2Fnews%3Ftopic%3Db%26output%3Drss&amp;topCount=10" target="_blank" rel="external">http://localhost/reader/OpenSocial/RssFeedGadget?feedUrl=http%3A%2F%2Fnews.google.com%2Fnews%3Ftopic%3Db%26output%3Drss&amp;topCount=10</a></p>
<img src="/blog/2011/11/07/Creating-OpenSocial-gadget/gadgetXml_2.png" alt="View of the widget XML" title="View of the widget XML">
<h2 id="Deploy-gadget-to-container"><a href="#Deploy-gadget-to-container" class="headerlink" title="Deploy gadget to container."></a>Deploy gadget to container.</h2><p><a href="http://www.liferay.com/downloads/liferay-portal/available-releases" target="_blank" rel="external">LifeRay</a> portal is a good choice in order to test OpenSocial gadgets. Though it written in Java this product is easy to install and run. You should have Java virtual machine on your test computer in order to run this portal. To install just extract zip archive and run \liferay-portal-6.1.0\tomcat-7.0.21\bin\startup.bat. Then tomcat web server will be run on port 8080 by default with Liferay portal. Looks impressive.</p>
<img src="/blog/2011/11/07/Creating-OpenSocial-gadget/LiferayFirstStart_2.png" alt="View of the LifeRay portal" title="View of the LifeRay portal">
<p>To add our fresh OpenSocial gadget to portal first login to LifeRay under administrator account. There are special quick login links o the main page. Press “Login as Bruno”. Then find menu in the top “Add”-&gt;”More”-&gt;”Install More Applications”. Scroll down, find “Open Social” link and click. Page should look similar to this:</p>
<img src="/blog/2011/11/07/Creating-OpenSocial-gadget/LifeRayInsertGadgetUrl_2.png" alt="View of the LifeRay Insert Gadget UI" title="View of the LifeRay Insert Gadget UI">
<p>Insert url to Rss gadget, press “Save”. Okay, now add gadget to the page. To achieve this navigate to main page or whatever page you like and select in top menu “Add”-&gt;”More”-&gt;”Gadgets”-&gt;”Rss Feed Widget”. Gadget should be added to page.</p>
<img src="/blog/2011/11/07/Creating-OpenSocial-gadget/LifeRayWithGadget_2.png" alt="View of the LifeRay with our gadget" title="View of the LifeRay with our gadget">
<p>Just what we need. Also, in gadget menu there are available option “Configuration”.</p>
<img src="/blog/2011/11/07/Creating-OpenSocial-gadget/GadgetSettings_2.png" alt="View of the LifeRay with configuration" title="View of the LifeRay with configuration">
<p>There are our gadget preferences, and they are managed by Liferay Container. We get access to this values via OpenSocial javascript API in WidgetHelper.js.</p>
<p>Also as a little surprise you can find out that our gadget is fully compatible with iGoogle gadgets, and you can add it to iGoogle page. To perform this you must follow next steps:</p>
<ol>
<li>Deploy your website to hosting that will be accessible by google. I have deployed it to <a href="http://apps.megaboich.com/rssreader" target="_blank" rel="external">http://apps.megaboich.com/rssreader</a>.</li>
<li>Ensure that application deployed correctly and gadget XML is available by public Url.</li>
<li>Go to <a href="http://www.google.com/ig" target="_blank" rel="external">http://www.google.com/ig</a> then login, press “Add gadgets” red button, on the next page in left bottom corner find “Add feed or gadget”. Then enter url for your gadget XML and confirm your action.</li>
</ol>
<img src="/blog/2011/11/07/Creating-OpenSocial-gadget/Gadget%20on%20iGoogle_2.png" alt="iGoogle with our gadget" title="iGoogle with our gadget">
<p>All sources are available at <a href="https://bitbucket.org/megaboich/simplerssreader" target="_blank" rel="external">BitBucket</a>.</p>
<p>Enjoy.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://megaboich.github.io/blog/blog/2011/11/07/Creating-OpenSocial-gadget/" data-id="cip1ocabh00081sun2sjao7ap" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/C/">C#</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/OpenSocial/">OpenSocial</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2012/03/02/Diff-Merge-Tool-Selector/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Diff Merge Tool Selector
        
      </div>
    </a>
  
  
    <a href="/blog/2011/08/12/Creating-Simple-RSS-Reader/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Creating Simple RSS Reader Web application with C# and Asp.Net MVC.</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Asp-Net-MVC/">Asp.Net MVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/C/">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/GIT-SVN/">GIT SVN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Javascript/">Javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/OpenSocial/">OpenSocial</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Powershell/">Powershell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/RSS/">RSS</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/Asp-Net-MVC/" style="font-size: 20px;">Asp.Net MVC</a> <a href="/blog/tags/C/" style="font-size: 20px;">C#</a> <a href="/blog/tags/GIT-SVN/" style="font-size: 10px;">GIT SVN</a> <a href="/blog/tags/Javascript/" style="font-size: 10px;">Javascript</a> <a href="/blog/tags/OpenSocial/" style="font-size: 10px;">OpenSocial</a> <a href="/blog/tags/Powershell/" style="font-size: 10px;">Powershell</a> <a href="/blog/tags/RSS/" style="font-size: 10px;">RSS</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2013/06/">June 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2012/08/">August 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2012/03/">March 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2011/11/">November 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2011/08/">August 2011</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2016/04/02/Setting-Up-Git-Svn-From-Very-Beginning/">Setting up Git-Svn from very beginning</a>
          </li>
        
          <li>
            <a href="/blog/2013/06/11/Javascript-implementation-of-custom-AStar-Algorithm/">Javascript implementation of custom A* algorithm</a>
          </li>
        
          <li>
            <a href="/blog/2012/08/06/PowerShell-View-Engine-Asp-style/">PowerShell View Engine - Asp style</a>
          </li>
        
          <li>
            <a href="/blog/2012/03/02/Diff-Merge-Tool-Selector/">Diff Merge Tool Selector</a>
          </li>
        
          <li>
            <a href="/blog/2011/11/07/Creating-OpenSocial-gadget/">Creating OpenSocial gadget with Asp.Net MVC</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Oleksandr Boiko<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/blog/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>

  </div>
</body>
</html>